%% Copernicus Publications Manuscript Preparation Template for LaTeX Submissions
%% ---------------------------------
%% This template should be used for copernicus.cls
%% The class file and some style files are bundled in the Copernicus Latex Package, which can be downloaded from the different journal webpages.
%% For further assistance please contact Copernicus Publications at: production@copernicus.org
%% https://publications.copernicus.org/for_authors/manuscript_preparation.html

%% I got this file from the LaTeX templates bundle at  https://www.geoscientific-model-development.net/submission.html


%% Please use the following documentclass and journal abbreviations for preprints and final revised papers.

%% 2-column papers and preprints
\documentclass[gmd]{copernicus}


%% \usepackage commands included in the copernicus.cls:
%\usepackage[german, english]{babel}
%\usepackage{tabularx}
%\usepackage{cancel}
%\usepackage{multirow}
%\usepackage{supertabular}
%\usepackage{algorithmic}
%\usepackage{algorithm}
%\usepackage{amsthm}
%\usepackage{float}
%\usepackage{subfig}
%\usepackage{rotating}


\begin{document}

\title{Machine Learning for Climate Datasets}


% \Author[affil]{given_name}{surname}

\Author[1]{Philip}{Brohan}

\affil[1]{Met Office Hadley Centre, Exeter, UK}

%% The [] brackets identify the author with the corresponding affiliation. 1, 2, 3, etc. should be inserted.


\correspondence{Philip Brohan (philip.brohan@metoffice.gov.uk)}

\runningtitle{ML for Climate}

\runningauthor{Brohan}


\received{}
\pubdiscuss{} %% only important for two-stage journals
\revised{}
\accepted{}
\published{}

%% These dates will be inserted by Copernicus Publications during the typesetting process.

\firstpage{1}

\maketitle

\begin{abstract}
Machine Learning (ML) is a very powerful tool for making generative models: models that can make detailed, complex output (often pictures) from a simple input specification. We can use this in science by making generative models of weather and climate --- by training ML models to output gridded fields of weather variables such as temperature and precipitation. Here we show that you can use a Variational AutoEncoder (VAE) to build a fast deep generative model linking physically-plausible weather fields to a complete, continuous, low-dimensional latent space. Such an ML model can be used in place of a General Circulation Model (GCM) for some purposes: We can do reanalysis by constraining the field output to match observations, or perturbation/attribution studies by using the ML model to estimate the effect of changing one variable on another (e.g. change in sea temperature on precipitation). The primary advantage of such an ML model over a traditional GCM is that it can be several orders of magnitude faster.
\end{abstract}


\copyrightstatement{Crown Copyright 2023} %% This section is optional and can be used for copyright transfers.


\introduction  %% \introduction[modified heading if necessary]

Traditional General Circulation Models (GCMs, \citet{phillips1956general}) are examples of {\em Generative Models}: a GCM will output a self-consistent and physically-plausible state of the weather. GCMs are extremely powerful and successful, but they do have important limitations: In particular they are {\em expensive} -- in both user effort and compute required --- so we have to limit the work we do with them.

Modern Machine Learning (ML) 


Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
\citet{smit54}
\citep{colu92}
\citep{gree00,phil99}
\citep[p.~32]{jame76}

\section{An ML Model Architecture for Climate Modeling}

\begin{figure}[h]
\includegraphics[width=8.3cm]{figures/ML_model_structure.pdf}
\caption{Conceptual model of an ML-based climate model.}
\label{ML_model_structure}
\end{figure}
    
\subsection{A reduced space representation from a Variational Autoencoder}

\begin{figure}[h]
\includegraphics[width=8.3cm]{figures/VAE_structure.pdf}
\caption{Model training architecture based on a Variational AutoEncoder.}
\label{VAE_structure}
\end{figure}
     
\subsection{Data Assimilation by constraining the reduced space}

\subsection{Extension by linking additional generative models}

\begin{figure}[h]
\includegraphics[width=8.3cm]{figures/Extension_structure.pdf}
\caption{Process for extending the model to addional variables.}
\label{Extension_structure}
\end{figure}
     

Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.


\section{An example model - monthly weather for the UK}

\subsection{Training data}

\subsection{ML model specification}

\subsection{Model Training and Validation}


\begin{figure}[h]
\includegraphics[width=8.3cm]{figures/training_progress.pdf}
\caption{Training progress: fraction of unexplained variance for each variable.}
\label{training_progress}
\end{figure}
    
Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.

\begin{figure}[h]
\includegraphics[width=8.3cm]{figures/model_validation.pdf}
\caption{Left column: VAE input, middle column: VAE output, right column: scatter}
\label{model_validation}
\end{figure}


\begin{figure}[h]
\includegraphics[width=8.3cm]{figures/model_validation_multi.pdf}
\caption{Black lines: VAE input, red lines: VAE output, and I::O scatter. Regional means for all verification months.}
\label{model_validation_multi}
\end{figure}


\section{Applying the model}


\subsection{An AMIP run}

\begin{figure}[h]
\includegraphics[width=8.3cm]{figures/fit_to_SST.pdf}
\caption{Black lines: VAE input, red lines: VAE output, and I::O scatter. Regional means for all verification months.}
\label{fit_to_SST}
\end{figure}
    
    
\subsection{A reanalysis run}

\begin{figure}[h]
\includegraphics[width=8.3cm]{figures/fit_to_SST+PRMSL.pdf}
\caption{Black lines: VAE input, red lines: VAE output, and I::O scatter. Regional means for all verification months.}
\label{fit_to_SST+PRMSL}
\end{figure}

\subsection{Attribution}

\begin{figure}[h]
\includegraphics[width=8.3cm]{figures/perturbation_method.pdf}
\caption{Process for estimating perturbation effects for an attribution study.}
\label{perturbation_method}
\end{figure}
    

\begin{figure}[h]
\includegraphics[width=8.3cm]{figures/perturbation_validation.pdf}
\caption{Results of increasing SST by 1C.}
\label{perturbation_validation}
\end{figure}
        

\subsection{Extending to climate services}

\begin{figure}[h]
\includegraphics[width=8.3cm]{figures/services_river_flow.pdf}
\caption{Extending the model to river flow prediction.}
\label{services_river_flow}
\end{figure}
         
    
Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.


\conclusions  %% \conclusions[modified heading if necessary]
Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.

%% The following commands are for the statements about the availability of data sets and/or software code corresponding to the manuscript.
%% It is strongly recommended to make use of these sections in case data sets and/or software code have been part of your research the article is based on.


\codedataavailability{The code needed to reproduce or build on this work is online at https://github.com/philip-brohan/ML\_monthly\_UK. The repository includes tools to download the data required.} %% use this section when having data sets and software code available



\authorcontribution{This paper is the work of Philip Brohan} %% this section is mandatory

\competinginterests{No competing interests are present.} %% this section is mandatory even if you declare that no competing interests are present


\begin{acknowledgements}
Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
\end{acknowledgements}



%% REFERENCES

\bibliographystyle{copernicus}
\bibliography{MLCD}

%%
%% URLs and DOIs can be entered in your BibTeX file as:
%%
%% URL = {http://www.xyz.org/~jones/idx_g.htm}
%% DOI = {10.5194/xyz}




\end{document}
